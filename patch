books/bookvol5 rewrite code into better form

Some of the code is compiler generated.
We rewrite it into more readable form.

