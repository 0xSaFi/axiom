\documentclass{article}
\usepackage{axiom}
\begin{document}
\title{\$SPAD/src/interp apply.lisp}
\author{The Axiom Team}
\maketitle
\begin{abstract}
\end{abstract}
\eject
\tableofcontents
\eject
\begin{chunk}{*}

(in-package "BOOT" )

;substituteIntoFunctorModemap(argl,modemap is [[dc,:sig],:.],e) ==
;  #dc^=#sig =>
;    keyedSystemError("S2GE0016",['"substituteIntoFunctorModemap",
;      '"Incompatible maps"])
;  #argl=#rest sig =>
;                        --here, we actually have a functor form
;    sig:= EQSUBSTLIST(argl,rest dc,sig)
;      --make new modemap, subst. actual for formal parametersinto modemap
;    Tl:= [[.,.,e]:= compOrCroak(a,m,e) for a in argl for m in rest sig]
;    substitutionList:= [[x,:T.expr] for x in rest dc for T in Tl]
;    [SUBLIS(substitutionList,modemap),e]
;  nil

(DEFUN |substituteIntoFunctorModemap| (|argl| |modemap| |e|)
  (PROG (|dc| |sig| |LETTMP#1| |Tl| |substitutionList|)
    (RETURN
      (SEQ (PROGN
             (SPADLET |dc| (CAAR |modemap|))
             (SPADLET |sig| (CDAR |modemap|))
             (COND
               ((NEQUAL (|#| |dc|) (|#| |sig|))
                (|keyedSystemError| 'S2GE0016
                    (CONS "substituteIntoFunctorModemap"
                          (CONS "Incompatible maps" NIL))))
               ((BOOT-EQUAL (|#| |argl|) (|#| (CDR |sig|)))
                (SPADLET |sig| (EQSUBSTLIST |argl| (CDR |dc|) |sig|))
                (SPADLET |Tl|
                         (PROG (G167960)
                           (SPADLET G167960 NIL)
                           (RETURN
                             (DO ((G167969 |argl| (CDR G167969))
                                  (|a| NIL)
                                  (G167970 (CDR |sig|)
                                      (CDR G167970))
                                  (|m| NIL))
                                 ((OR (ATOM G167969)
                                      (PROGN
                                        (SETQ |a| (CAR G167969))
                                        NIL)
                                      (ATOM G167970)
                                      (PROGN
                                        (SETQ |m| (CAR G167970))
                                        NIL))
                                  (NREVERSE0 G167960))
                               (SEQ (EXIT
                                     (SETQ G167960
                                      (CONS
                                       (PROGN
                                         (SPADLET |LETTMP#1|
                                          (|compOrCroak| |a| |m| |e|))
                                         (SPADLET |e|
                                          (CADDR |LETTMP#1|))
                                         |LETTMP#1|)
                                       G167960))))))))
                (SPADLET |substitutionList|
                         (PROG (G167984)
                           (SPADLET G167984 NIL)
                           (RETURN
                             (DO ((G167990 (CDR |dc|)
                                      (CDR G167990))
                                  (|x| NIL)
                                  (G167991 |Tl| (CDR G167991))
                                  (T$ NIL))
                                 ((OR (ATOM G167990)
                                      (PROGN
                                        (SETQ |x| (CAR G167990))
                                        NIL)
                                      (ATOM G167991)
                                      (PROGN
                                        (SETQ T$ (CAR G167991))
                                        NIL))
                                  (NREVERSE0 G167984))
                               (SEQ (EXIT
                                     (SETQ G167984
                                      (CONS (CONS |x| (CAR T$))
                                       G167984))))))))
                (CONS (SUBLIS |substitutionList| |modemap|)
                      (CONS |e| NIL)))
               ('T NIL)))))))

;--% APPLY MODEMAPS


\end{chunk}
\eject
\begin{thebibliography}{99}
\bibitem{1} nothing
\end{thebibliography}
\end{document}
