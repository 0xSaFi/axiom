\documentclass{article}
\usepackage{axiom}
\begin{document}
\title{\$SPAD/src/interp intfile.lisp}
\author{The Axiom Team}
\maketitle
\begin{abstract}
\end{abstract}
\eject
\tableofcontents
\eject
<<*>>=

;shoeInternFile(fn)==
;   a:=shoeInputFile fn
;   if null a
;   then WRITE_-LINE (CONCAT(fn,'" not found"),_*TERMINAL_-IO_*)
;   else shoeIntern incRgen a

(DEFUN |shoeInternFile| (|fn|)
  (PROG (|a|)
    (RETURN
      (PROGN
        (SETQ |a| (|shoeInputFile| |fn|))
        (COND
          ((NULL |a|)
           (WRITE-LINE (CONCAT |fn| " not found") *TERMINAL-IO*))
          ('T (|shoeIntern| (|incRgen| |a|))))))))

;shoeIntern (s)==
;   StreamNull s => nil
;   f:=CAR s
;   # f < 8 => shoeIntern CDR s
;   f.0=char " " =>shoeIntern CDR s
;   a:=INTERN SUBSTRING (f,0,8)
;   [b,c]:= shoeStrings CDR s
;   SETF(GET (a,"MSGS"),b)
;   shoeIntern c

(DEFUN |shoeIntern| (|s|)
  (PROG (|c| |b| |LETTMP#1| |a| |f|)
    (RETURN
      (COND
        ((|StreamNull| |s|) NIL)
        ('T
         (PROGN
           (SETQ |f| (CAR |s|))
           (COND
             ((< (LENGTH |f|) 8) (|shoeIntern| (CDR |s|)))
             ((EQUAL (ELT |f| 0) (|char| '| |))
              (|shoeIntern| (CDR |s|)))
             ('T
              (PROGN
                (SETQ |a| (INTERN (SUBSTRING |f| 0 8)))
                (SETQ |LETTMP#1| (|shoeStrings| (CDR |s|)))
                (SETQ |b| (CAR |LETTMP#1|))
                (SETQ |c| (CADR |LETTMP#1|))
                (SETF (GET |a| 'MSGS) |b|)
                (|shoeIntern| |c|))))))))))

;shoeStrings (stream)==
;   StreamNull stream => ['"",stream]
;   a:=CAR stream
;   if a.0^=char " "
;   then ['"",stream]
;   else
;       [h,t]:=shoeStrings(cdr stream)
;       [CONCAT(a,h),t]

(DEFUN |shoeStrings| (|stream|)
  (PROG (|t| |h| |LETTMP#1| |a|)
    (RETURN
      (COND
        ((|StreamNull| |stream|) (LIST "" |stream|))
        ('T
         (PROGN
           (SETQ |a| (CAR |stream|))
           (COND
             ((NOT (EQUAL (ELT |a| 0) (|char| '| |)))
              (LIST "" |stream|))
             ('T (SETQ |LETTMP#1| (|shoeStrings| (CDR |stream|)))
              (SETQ |h| (CAR |LETTMP#1|)) (SETQ |t| (CADR |LETTMP#1|))
              (LIST (CONCAT |a| |h|) |t|)))))))))

@
\eject
\begin{thebibliography}{99}
\bibitem{1} nothing
\end{thebibliography}
\end{document}
