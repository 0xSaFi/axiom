\documentclass{article}
\usepackage{axiom}
\begin{document}
\title{\$SPAD/src/interp dq.lisp}
\author{The Axiom Team}
\maketitle
\begin{abstract}
\end{abstract}
\eject
\tableofcontents
\eject
<<*>>=

(IN-PACKAGE "BOOT")

;-- Dequeue functions
 
;dqUnit s==(a:=[s];CONS(a,a))

;-- dqUnit makes a unit dq i.e. a dq with one item, from the item
 
(DEFUN |dqUnit| (|s|)
 (PROG (|a|)
  (RETURN
   (PROGN
    (SETQ |a| (LIST |s|))
    (CONS |a| |a|)))))

;dqUnitCopy s== dqUnit(CAAR s)

;-- dqUnitCopy copies a unit dq

(DEFUN |dqUnitCopy| (|s|)
 (PROG NIL
  (RETURN (|dqUnit| (CAAR |s|)))))

;-- dqAppend appends 2 dq's, destroying the first
 
;dqAppend(x,y)==
;    if null x
;    then y
;    else if null y
;         then x
;         else
;              RPLACD (CDR x,CAR y)
;              RPLACD (x,    CDR y)
;              x
 
(DEFUN |dqAppend| (|x| |y|)
 (PROG NIL
  (RETURN
   (COND
    ((NULL |x|) |y|)
    ((NULL |y|) |x|)
    ((QUOTE T) (RPLACD (CDR |x|) (CAR |y|)) (RPLACD |x| (CDR |y|)) |x|)))))

;dqConcat ld==
;    if null ld
;    then nil
;    else if null rest ld
;         then first ld
;         else dqAppend(first ld,dqConcat rest ld)

;-- dqConcat concatenates a list of dq's, destroying all but the last
 
(DEFUN |dqConcat| (|ld|)
 (PROG NIL
  (RETURN
   (COND
    ((NULL |ld|) NIL)
    ((NULL (CDR |ld|)) (CAR |ld|))
    ((QUOTE T) (|dqAppend| (CAR |ld|) (|dqConcat| (CDR |ld|))))))))

;dqToList s==if null s then nil else CAR s
 
(DEFUN |dqToList| (|s|)
 (PROG NIL
  (RETURN
   (COND
    ((NULL |s|) NIL)
    ((QUOTE T) (CAR |s|))))))

;dqAddAppend(x,y)==
;    if null x
;    then nil
;    else if null y
;         then nil
;         else
;              RPLACD (CDR x,CAR y)
;              RPLACD (x,    CDR y)
;              x

;-- dqAddAppend transforms a dq to a list

(DEFUN |dqAddAppend| (|x| |y|)
 (PROG NIL
  (RETURN
   (COND
    ((NULL |x|) NIL)
    ((NULL |y|) NIL)
    ((QUOTE T) (RPLACD (CDR |x|) (CAR |y|)) (RPLACD |x| (CDR |y|)) |x|)))))
@
\eject
\begin{thebibliography}{99}
\bibitem{1} nothing
\end{thebibliography}
\end{document}
