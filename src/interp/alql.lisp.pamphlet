\documentclass{article}
\usepackage{axiom}
\begin{document}
\title{\$SPAD/src/interp alql.lisp}
\author{The Axiom Team}
\maketitle
\begin{abstract}
\end{abstract}
\eject
\tableofcontents
\eject
<<*>>=

;; Note: this seems to only be used in the ICARD (IndexCard) domain

(IN-PACKAGE "BOOT" )

;getBrowseDatabase(kind) ==
;  $includeUnexposed? : local := true
;  not FUNCALL("member",kind,'("o" "k" "c" "d" "p")) => nil
;  grepConstruct('"*",INTERN kind)

(DEFUN |getBrowseDatabase| (|kind|)
 (PROG (|$includeUnexposed?|)
  (DECLARE (SPECIAL |$includeUnexposed?|))
  (RETURN
   (PROGN
    (SPADLET |$includeUnexposed?| (QUOTE T))
    (COND
     ((NULL (FUNCALL (QUOTE |member|) |kind| (QUOTE ("o" "k" "c" "d" "p"))))
       NIL)
     ((QUOTE T)
      (|grepConstruct| (MAKESTRING "*") (INTERN |kind|)))))))) 

;stringMatches?(pattern,subject) ==
;  FIXP basicMatch?(pattern,subject) => true
;  false

(DEFUN |stringMatches?| (|pattern| |subject|)
 (COND
  ((FIXP (|basicMatch?| |pattern| |subject|)) (QUOTE T))
  ((QUOTE T) NIL))) 

;alqlGetKindString(x) ==
;  x.0 = char 'a or x.0 = char 'o => SUBSTRING(dbPart(x,5,1),0,1)
;  SUBSTRING(x,0,1)

(DEFUN |alqlGetKindString| (|x|)
 (COND
  ((OR (BOOT-EQUAL (ELT |x| 0) (|char| (QUOTE |a|)))
       (BOOT-EQUAL (ELT |x| 0) (|char| (QUOTE |o|))))
    (SUBSTRING (|dbPart| |x| 5 1) 0 1))
  ((QUOTE T)
    (SUBSTRING |x| 0 1)))) 

;alqlGetOrigin(x) ==
;  field :=dbPart(x,5,1)
;  k := charPosition(char '_(,field,2)
;  SUBSTRING(field,1,k-1)

(DEFUN |alqlGetOrigin| (|x|)
 (PROG (|field| |k|)
  (RETURN
   (PROGN
    (SPADLET |field| (|dbPart| |x| 5 1))
    (SPADLET |k|
     (|charPosition| (|char| (QUOTE |(|)) |field| 2))
     (SUBSTRING |field| 1 (SPADDIFFERENCE |k| 1)))))) 

;alqlGetParams(x) ==
;  field :=dbPart(x,5,1)
;  k := charPosition(char '_(,field,2)
;  SUBSTRING(field,k,nil)

(DEFUN |alqlGetParams| (|x|)
 (PROG (|field| |k|)
  (RETURN
   (PROGN
    (SPADLET |field| (|dbPart| |x| 5 1))
    (SPADLET |k|
     (|charPosition| (|char| (QUOTE |(|)) |field| 2))
     (SUBSTRING |field| |k| NIL))))) 

@
\eject
\begin{thebibliography}{99}
\bibitem{1} nothing
\end{thebibliography}
\end{document}
