\documentclass{article}
\usepackage{axiom}
\begin{document}
\title{\$SPAD/src/interp nruntime.lisp}
\author{The Axiom Team}
\maketitle
\begin{abstract}
\end{abstract}
\eject
\tableofcontents
\eject
<<*>>=
(IN-PACKAGE "BOOT" )

;unloadOneConstructor(cnam,fn) ==
;    REMPROP(cnam,'LOADED)
;    SETF(SYMBOL_-FUNCTION cnam,mkAutoLoad(fn, cnam))

(DEFUN |unloadOneConstructor| (|cnam| |fn|)
  (PROGN
    (REMPROP |cnam| 'LOADED)
    (SETF (SYMBOL-FUNCTION |cnam|) (|mkAutoLoad| |fn| |cnam|))))

;devaluateDeeply x ==
;  VECP x => devaluate x
;  atom x => x
;  [devaluateDeeply y for y in x]

(DEFUN |devaluateDeeply| (|x|)
  (PROG ()
    (RETURN
      (SEQ (COND
             ((VECP |x|) (|devaluate| |x|))
             ((ATOM |x|) |x|)
             ('T
              (PROG (G166066)
                (SPADLET G166066 NIL)
                (RETURN
                  (DO ((G166071 |x| (CDR G166071)) (|y| NIL))
                      ((OR (ATOM G166071)
                           (PROGN (SETQ |y| (CAR G166071)) NIL))
                       (NREVERSE0 G166066))
                    (SEQ (EXIT (SETQ G166066
                                     (CONS (|devaluateDeeply| |y|)
                                      G166066)))))))))))))

;lookupDisplay(op,sig,vectorOrForm,suffix) ==
;  null $NRTmonitorIfTrue => nil
;  prefix := (suffix = '"" => ">"; "<")
;  sayBrightly
;    concat(prefix,formatOpSignature(op,sig),
;        '" from ", prefix2String devaluateDeeply vectorOrForm,suffix)

(DEFUN |lookupDisplay| (|op| |sig| |vectorOrForm| |suffix|)
  (PROG (|prefix|)
    (RETURN
      (COND
        ((NULL |$NRTmonitorIfTrue|) NIL)
        ('T
         (SPADLET |prefix|
                  (COND
                    ((BOOT-EQUAL |suffix| (MAKESTRING "")) '>)
                    ('T '<)))
         (|sayBrightly|
             (|concat| |prefix| (|formatOpSignature| |op| |sig|)
                 (MAKESTRING " from ")
                 (|prefix2String| (|devaluateDeeply| |vectorOrForm|))
                 |suffix|)))))))

;isInstantiated [op,:argl] ==
;  u:= lassocShiftWithFunction(argl,HGET($ConstructorCache,op),'domainEqualList)
;    => CDRwithIncrement u
;  nil

(DEFUN |isInstantiated| (G166088)
  (PROG (|op| |argl| |u|)
    (RETURN
      (PROGN
        (SPADLET |op| (CAR G166088))
        (SPADLET |argl| (CDR G166088))
        (COND
          ((SPADLET |u|
                    (|lassocShiftWithFunction| |argl|
                        (HGET |$ConstructorCache| |op|)
                        '|domainEqualList|))
           (|CDRwithIncrement| |u|))
          ('T NIL))))))

;isCategoryPackageName nam ==
;  p := PNAME opOf nam
;  p.(MAXINDEX p) = char '_&

(DEFUN |isCategoryPackageName| (|nam|)
  (PROG (|p|)
    (RETURN
      (PROGN
        (SPADLET |p| (PNAME (|opOf| |nam|)))
        (BOOT-EQUAL (ELT |p| (MAXINDEX |p|)) (|char| '&))))))

@
\eject
\begin{thebibliography}{99}
\bibitem{1} nothing
\end{thebibliography}
\end{document}
